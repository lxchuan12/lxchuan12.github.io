(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{421:function(t,s,a){t.exports=a.p+"assets/img/open-src-app.vue.51fd0181.png"},533:function(t,s,a){t.exports=a.p+"assets/img/open-in-editor-error.4fae42eb.png"},534:function(t,s,a){t.exports=a.p+"assets/img/debug.7f563e4f.png"},535:function(t,s,a){t.exports=a.p+"assets/img/search.b618b12f.png"},536:function(t,s,a){t.exports=a.p+"assets/img/debug-launch.d30ca44e.png"},611:function(t,s,a){"use strict";a.r(s);var n=a(31),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"据说-99-的人不知道-vue-devtools-还能直接打开对应组件文件-本文原理揭秘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#据说-99-的人不知道-vue-devtools-还能直接打开对应组件文件-本文原理揭秘"}},[t._v("#")]),t._v(" 据说 99% 的人不知道 vue-devtools 还能直接打开对应组件文件？本文原理揭秘")]),t._v(" "),n("h2",{attrs:{id:"_1-前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-前言"}},[t._v("#")]),t._v(" 1. 前言")]),t._v(" "),n("blockquote",[n("p",[t._v("你好，我是"),n("a",{attrs:{href:"https://lxchuan12.gitee.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("若川"),n("OutboundLink")],1),t._v("，微信搜索"),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/c3hFML3XN9KCUetDOZd-DQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("「若川视野」"),n("OutboundLink")],1),t._v("关注我，专注前端技术分享，一个愿景是帮助5年内前端开阔视野走向前列的公众号。欢迎加我微信"),n("code",[t._v("ruochuan12")]),t._v("，长期交流学习。")])]),t._v(" "),n("blockquote",[n("p",[t._v("这是"),n("code",[t._v("学习源码整体架构系列")]),t._v(" 之 launch-editor 源码（第九篇）。学习源码整体架构系列文章("),n("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650746362&idx=1&sn=afe3a26cdbde1d423aae4fa99355f369&chksm=88662e76bf11a760a7f0a8565b9e8d52f5e4f056dc2682f213eec6475127d71f6f1d203d6c3a&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("有哪些必看的JS库"),n("OutboundLink")],1),t._v(")："),n("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744496&idx=1&sn=0f149e9436cb77bf9fc1bfb47aedd334&chksm=8866253cbf11ac2a53b385153cd8e9a0c4018b6b566750cf0b5d61d17afa2e90b52d36db8054&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("jQuery"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744505&idx=1&sn=26801ad6c2a5eb9cf64e7556b6478d39&chksm=88662535bf11ac23eea3f76335f6777e2acbf4ee660b5616148e14ffbefc0e8520806db21056&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("underscore"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744514&idx=1&sn=776336d888d06bfe72cb4d5b07a4b90c&chksm=8866254ebf11ac5822fc078082603f77a4b4d9b487c9f4d7069acb12c727c46c75946fa9b0cd&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("lodash"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744551&idx=1&sn=4d79c2fa97d7c737aab70055c7ec7fa3&chksm=8866256bbf11ac7d9e2269f3638a705d5e5f45056d53ad2faf17b814e4c46ec6b0ba52571bde&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("sentry"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744584&idx=1&sn=b14f8a762f132adcf0f7e3e075ee2ded&chksm=88662484bf11ad922ed27d45873af838298949eea381545e82a511cabf0c6fc6876a8370c6fb&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuex"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744604&idx=1&sn=51d8d865c9848fd59f7763f5fb9ce789&chksm=88662490bf11ad86061ae76ff71a1177eeddab02c38d046eecd0e1ad25dc16f7591f91e9e3b2&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("axios"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650744703&idx=1&sn=cfb9580241228993e4d376017234ff79&chksm=886624f3bf11ade5f5e37520f6b1291417bcea95f222906548b863f4b61d20e7508eb419eb85&token=192125900&lang=zh_CN&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("koa"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzA5MjQwMzQyNw==&mid=2650745007&idx=1&sn=1fd6f3caeff6ab61b8d5f644a1dbb7df&chksm=88662b23bf11a23573509a01f941d463b0c61e890b2069427c78c26296197077da359c522fe8&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux"),n("OutboundLink")],1),t._v("。整体架构这词语好像有点大，姑且就算是源码整体结构吧，主要就是学习是代码整体结构，不深究其他不是主线的具体函数的实现。本篇文章学习的是实际仓库的代码。下一篇应该是《"),n("strong",[t._v("学习 Vuex 4 源码整体架构，深入理解其原理及provide/inject原理")]),t._v("》。")])]),t._v(" "),n("blockquote",[n("p",[n("a",{attrs:{href:"https://github.com/lxchuan12/open-in-editor.git",target:"_blank",rel:"noopener noreferrer"}},[t._v("本文仓库地址"),n("OutboundLink")],1),t._v("："),n("code",[t._v("git clone https://github.com/lxchuan12/open-in-editor.git")]),t._v("，本文最佳阅读方式，克隆仓库自己动手调试，容易吸收消化。")])]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("要是有人说到怎么读源码，正在读文章的你能推荐我的源码系列文章，那真是无以为报啊")]),t._v("。")])]),t._v(" "),n("p",[t._v("我的文章尽量写得让想看源码又不知道怎么看的读者能看懂。我都是推荐使用"),n("strong",[t._v("搭建环境断点调试源码学习")]),t._v("，"),n("strong",[t._v("哪里不会点哪里")]),t._v("，"),n("strong",[t._v("边调试边看，而不是硬看")]),t._v("。正所谓："),n("strong",[t._v("授人与鱼不如授人予渔")]),t._v("。")]),t._v(" "),n("p",[t._v("阅读本文后你将学到：")]),t._v(" "),n("ol",[n("li",[t._v("如何解决该功能报错问题"),n("br")]),t._v(" "),n("li",[t._v("如何调试学习源码"),n("br")]),t._v(" "),n("li",[n("code",[t._v("launch-editor-middleware、launch-editor")]),t._v(" 等实现原理"),n("br")])]),t._v(" "),n("h3",{attrs:{id:"_1-1-短时间找不到页面对应源文件的场景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-短时间找不到页面对应源文件的场景"}},[t._v("#")]),t._v(" 1.1 短时间找不到页面对应源文件的场景")]),t._v(" "),n("p",[t._v("不知道你们有没有碰到这样的场景，打开你自己（或者你同事）开发的页面，却短时间难以找到对应的源文件。")]),t._v(" "),n("p",[t._v("这时你可能会想要是能有"),n("strong",[t._v("点击页面按钮自动用编辑器打开对应文件")]),t._v("的功能，那该多好啊。")]),t._v(" "),n("p",[t._v("而"),n("code",[t._v("vue-devtools")]),t._v("提供了这样的功能，也许你不知道。我觉得很大一部分人都不知道，因为感觉很多人都不常用"),n("code",[t._v("vue-devtools")]),t._v("。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(421),alt:"open-in-editor"}})]),t._v(" "),n("p",[t._v("你也许会问，我不用"),n("code",[t._v("vue")]),t._v("，我用"),n("code",[t._v("react")]),t._v("有没有类似功能啊，有啊，请看"),n("a",{attrs:{href:"https://github.com/zthxxx/react-dev-inspector",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-dev-inspector"),n("OutboundLink")],1),t._v("。你可能还会问，支持哪些编辑器呀，主流的 "),n("code",[t._v("vscode、webstorm、atom、sublime")]),t._v(" 等都支持，更多可以看"),n("a",{attrs:{href:"https://github.com/yyx990803/launch-editor#supported-editors",target:"_blank",rel:"noopener noreferrer"}},[t._v("这个列表 Supported editors"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("p",[t._v("本文就是根据学习尤大写的 "),n("a",{attrs:{href:"https://github.com/yyx990803/launch-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("launch-editor"),n("OutboundLink")],1),t._v(" 源码，本着"),n("strong",[t._v("知其然，知其所以然")]),t._v("的宗旨，探究 "),n("code",[t._v("vue-devtools")]),t._v("「在编辑器中打开组件」功能实现原理。")]),t._v(" "),n("h3",{attrs:{id:"_1-2-一句话简述其原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-一句话简述其原理"}},[t._v("#")]),t._v(" 1.2 一句话简述其原理")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("code path/to/file\n")])])]),n("p",[t._v("一句话简述原理：利用"),n("code",[t._v("nodejs")]),t._v("中的"),n("code",[t._v("child_process")]),t._v("，执行了类似"),n("code",[t._v("code path/to/file")]),t._v("命令，于是对应编辑器就打开了相应的文件，而对应的编辑器则是通过在进程中执行"),n("code",[t._v("ps x")]),t._v("（"),n("code",[t._v("Window")]),t._v("则用"),n("code",[t._v("Get-Process")]),t._v("）命令来查找的，当然也可以自己指定编辑器。")]),t._v(" "),n("h3",{attrs:{id:"_1-3-打开编辑器无法打开组件的报错解决方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-打开编辑器无法打开组件的报错解决方法"}},[t._v("#")]),t._v(" 1.3 打开编辑器无法打开组件的报错解决方法")]),t._v(" "),n("p",[t._v("而你真正用这个功能时，你可能碰到报错，说不能打开这个文件。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("Could not "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v(" App.vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" the editor.\n\nTo specify an editor, specify the EDITOR "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),t._v(" variable or "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"editor"')]),t._v(" field to your Vue project config.\n")])])]),n("p",[n("img",{attrs:{src:a(533),alt:"控制台不能打开编辑器的错误提示"}})]),t._v(" "),n("blockquote",[n("p",[t._v("这里说明下写这篇文章时用的是 "),n("code",[t._v("Windows")]),t._v(" 电脑，"),n("code",[t._v("VSCode")]),t._v(" 编辑器，在"),n("code",[t._v("Ubuntu")]),t._v("子系统下使用的终端工具。同时推荐我的文章"),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/MHngeDABRV3z2HmN5DRrEw",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 ohmyzsh 打造 windows、ubuntu、mac 系统高效终端命令行工具"),n("OutboundLink")],1),t._v("，"),n("strong",[t._v("用过的都说好")]),t._v("。")])]),t._v(" "),n("p",[n("strong",[t._v("解决办法也简单，就是这句英文的意思")]),t._v("。")]),t._v(" "),n("h4",{attrs:{id:"_1-3-1-方法一-先确保在终端能用命令打开你使用的编辑器-文中以vscode为例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-方法一-先确保在终端能用命令打开你使用的编辑器-文中以vscode为例"}},[t._v("#")]),t._v(" 1.3.1 方法一：先确保在终端能用命令打开你使用的编辑器，文中以"),n("code",[t._v("VSCode")]),t._v("为例")]),t._v(" "),n("p",[t._v("如果你的命令行本身就不能运行"),n("code",[t._v("code")]),t._v("等命令打开编辑器，那肯定是报错的。这时需要把"),n("code",[t._v("VSCode")]),t._v("注入到命令行终端中。\n注入方法也简单。我的交流群里有小伙伴提供了"),n("code",[t._v("mac")]),t._v("电脑的截图。")]),t._v(" "),n("p",[n("code",[t._v("mac")]),t._v(" 电脑在 "),n("code",[t._v("VSCode")]),t._v(" "),n("code",[t._v("command + shift + p")]),t._v("，"),n("code",[t._v("Windows")]),t._v(" 则是 "),n("code",[t._v("ctrl + shift + p")]),t._v("。然后输入"),n("code",[t._v("shell")]),t._v("，选择安装"),n("code",[t._v("code")]),t._v("。如下图：")]),t._v(" "),n("p",[n("a",{attrs:{href:"./images/path-install-code.png"}},[t._v("Install 'code' command in PATH")])]),t._v(" "),n("p",[t._v("这样就能在终端中打开"),n("code",[t._v("VSCode")]),t._v("的了。")]),t._v(" "),n("p",[t._v("如果能在终端打开使用命令编辑器能打开，但实际上还是报错，那么大概率是没有识别到你的编辑器。\n那么可以通过方法二设置指定编辑器。")]),t._v(" "),n("h4",{attrs:{id:"_1-3-2-方法二-具体说明编辑器-在环境变量中说明指定编辑器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-方法二-具体说明编辑器-在环境变量中说明指定编辑器"}},[t._v("#")]),t._v(" 1.3.2 方法二：具体说明编辑器，在环境变量中说明指定编辑器")]),t._v(" "),n("p",[t._v("在"),n("code",[t._v("vue")]),t._v("项目的根目录下，对应本文则是："),n("code",[t._v("vue3-project")]),t._v("，添加"),n("code",[t._v(".env.delelopment")]),t._v("文件，其内容是"),n("code",[t._v("EDITOR=code")]),t._v("。"),n("strong",[t._v("这里重点说明下，我的 "),n("code",[t._v("vue-cli")]),t._v(" 版本是"),n("code",[t._v("4.5.12")]),t._v("，好像在"),n("code",[t._v("vue-cli 3.5")]),t._v("及以上版本才支持自定义"),n("code",[t._v("EDITOR")]),t._v("这样的环境变量")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .env.development")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当然，我的命令行终端已经有了code这个命令。")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EDITOR")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("code\n")])])]),n("blockquote",[n("p",[t._v("不用指定编辑器的对应路径（"),n("code",[t._v("c/Users/lxchu/AppData/Local/Programs/Microsoft VS Code/bin/code")]),t._v("），因为会报错。为什么会报错，因为我看了源码且试过。因为会被根据空格截断，变成"),n("code",[t._v("c/Users/lxchu/AppData/Local/Programs/Microsoft")]),t._v("，当然就报错了。")])]),t._v(" "),n("p",[t._v("也有可能你的编辑器路径有中文路径导致报错，可以在环境变量中添加你的编辑器路径。")]),t._v(" "),n("p",[n("strong",[t._v("如果你通过以上方法，还没解决报错问题。欢迎留言，或者加我微信 "),n("code",[t._v("ruochuan12")]),t._v(" 交流。毕竟电脑环境不一，很难保证所有人都能正常执行，但我们知道了其原理，就很容易解决问题")]),t._v("。")]),t._v(" "),n("p",[t._v("接下来我们从源码角度探究「在编辑器中打开组件」功能的实现原理。")]),t._v(" "),n("h2",{attrs:{id:"_2-vue-devtools-open-component-in-editor-文档"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-vue-devtools-open-component-in-editor-文档"}},[t._v("#")]),t._v(" 2. vue-devtools Open component in editor 文档")]),t._v(" "),n("p",[t._v("探究原理之前，先来看看"),n("code",[t._v("vue-devtools")]),t._v("官方文档。")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#open-component-in-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuejs/vue-devtools"),n("OutboundLink")],1),t._v("\n文档")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("Open component in editor")]),n("br"),t._v("\nTo enable this feature, follow "),n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools/blob/dev/docs/open-in-editor.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("this guide"),n("OutboundLink")],1),t._v(".")])]),t._v(" "),n("p",[t._v("这篇指南中写了在"),n("code",[t._v("Vue CLI 3")]),t._v("中是"),n("strong",[t._v("开箱即用")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("Vue CLI "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" supports this feature out-of-the-box when running vue-cli-service serve.\n")])])]),n("p",[t._v("也详细写了如何在"),n("code",[t._v("Webpack")]),t._v("下使用。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. Import the package:")]),t._v("\nvar openInEditor "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'launch-editor-middleware'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. In the devServer option, register the /__open-in-editor HTTP route:")]),t._v("\ndevServer: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  before "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    app.use"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/__open-in-editor'")]),t._v(", openInEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3. The editor to launch is guessed. You can also specify the editor app with the editor option. See the supported editors list.")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用哪个编辑器打开会自动猜测。你也可以具体指明编辑器。这里显示更多的支持编辑器列表")]),t._v("\nopenInEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'code'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 4. You can now click on the name of the component in the Component inspector pane (if the devtools knows about its file source, a tooltip will appear).")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果`vue-devtools`开发者工具有提示点击的组件的显示具体路径，那么你可以在编辑器打开。")]),t._v("\n")])])]),n("p",[t._v("同时也写了如何在"),n("code",[t._v("Node.js")]),t._v("中使用等。")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("Node.js")]),n("br"),t._v("\nYou can use the "),n("a",{attrs:{href:"https://github.com/yyx990803/launch-editor#usage",target:"_blank",rel:"noopener noreferrer"}},[t._v("launch-editor"),n("OutboundLink")],1),t._v(" package to setup an HTTP route with the "),n("code",[t._v("/__open-in-editor")]),t._v(" path. It will receive file as an URL variable.")])]),t._v(" "),n("p",[t._v("查看更多可以看"),n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools/blob/dev/docs/open-in-editor.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("这篇指南"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h2",{attrs:{id:"_3-环境准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-环境准备工作"}},[t._v("#")]),t._v(" 3. 环境准备工作")]),t._v(" "),n("p",[t._v("熟悉我的读者，都知道我都是"),n("strong",[t._v("推荐调试看源码")]),t._v("的，正所谓："),n("strong",[t._v("哪里不会点哪里")]),t._v("。而且调试一般都写得很详细，是希望能帮助到一部分人知道如何看源码。于是我特意新建一个仓库"),n("a",{attrs:{href:"https://github.com/lxchuan12/open-in-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("open-in-editor"),n("OutboundLink")],1),t._v(" "),n("code",[t._v("git clone https://github.com/lxchuan12/open-in-editor.git")]),t._v("，便于大家克隆学习。")]),t._v(" "),n("p",[t._v("安装"),n("code",[t._v("vue-cli")])]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g @vue/cli\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OR")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" global "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" @vue/cli\n")])])]),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("node -V\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# v14.16.0")]),t._v("\nvue -V \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# @vue/cli 4.5.12")]),t._v("\nvue create vue3-project\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 这里选择的是vue3、vue2也是一样的。")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Please pick a preset: Default (Vue 3 Preview) ([Vue 3] babel, eslint)")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# OR")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])]),n("p",[t._v("这里同时说明下我的vscode版本。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("code -v\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.55")]),t._v(".2\n")])])]),n("p",[t._v("前文提到的"),n("code",[t._v("Vue CLI 3")]),t._v("中"),n("strong",[t._v("开箱即用")]),t._v("和"),n("code",[t._v("Webpack")]),t._v("使用方法。")]),t._v(" "),n("p",[n("code",[t._v("vue3-project/package.json")]),t._v("中有一个"),n("code",[t._v("debug")]),t._v("按钮。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(534),alt:"debug示意图"}})]),t._v(" "),n("p",[t._v("选择第一项，serve "),n("code",[t._v("vue-cli-service serve")]),t._v("。")]),t._v(" "),n("p",[t._v("我们来搜索下"),n("code",[t._v("'launch-editor-middleware'")]),t._v("这个中间件，一般来说搜索不到"),n("code",[t._v("node_modules")]),t._v("下的文件，需要设置下。当然也有个简单做法。就是「排除的文件」右侧旁边有个设置图标「使用“排查设置”与“忽略文件”」，点击下。")]),t._v(" "),n("p",[t._v("其他的就不赘述了。可以看这篇知乎回答："),n("a",{attrs:{href:"https://www.zhihu.com/question/309220217/answer/586510407",target:"_blank",rel:"noopener noreferrer"}},[t._v("vscode怎么设置可以搜索包含node_modules中的文件?"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("这时就搜到了"),n("code",[t._v("vue3-project/node_modules/@vue/cli-service/lib/commands/serve.js")]),t._v("中有使用这个中间件。")]),t._v(" "),n("p",[t._v("如下图所示：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(535),alt:"搜索node_modules下的文件 - launch-editor-middleware 中间件"}})]),t._v(" "),n("h2",{attrs:{id:"_4-vue-devtools-开箱即用具体源码实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-vue-devtools-开箱即用具体源码实现"}},[t._v("#")]),t._v(" 4. vue-devtools 开箱即用具体源码实现")]),t._v(" "),n("p",[t._v("接着我们来看"),n("code",[t._v("Vue CLI 3")]),t._v("中"),n("strong",[t._v("开箱即用")]),t._v("具体源码实现。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue3-project/node_modules/@vue/cli-service/lib/commands/serve.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 46行")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" launchEditorMiddleware "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'launch-editor-middleware'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 192行")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("before")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// launch editor support.")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this works with vue-devtools & @vue/cli-overlay")]),t._v("\n    app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/__open-in-editor'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("launchEditorMiddleware")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("To specify an editor, specify the EDITOR env variable or ")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('add "editor" field to your Vue project config.\\n')]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略若干代码...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("点击"),n("code",[t._v("vue-devtools")]),t._v("中的时，会有一个请求，"),n("code",[t._v("http://localhost:8080/__open-in-editor?file=src/App.vue")]),t._v("，不出意外就会打开该组件啦。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(421),alt:"open src/App.vue in editor"}})]),t._v(" "),n("p",[t._v("接着我们在"),n("code",[t._v("launchEditorMiddleware")]),t._v("的具体实现。")]),t._v(" "),n("h2",{attrs:{id:"_5-launch-editor-middleware"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-launch-editor-middleware"}},[t._v("#")]),t._v(" 5. launch-editor-middleware")]),t._v(" "),n("p",[t._v("看源码时，先看调试截图。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(536),alt:"debug-launch"}})]),t._v(" "),n("p",[t._v("在"),n("code",[t._v("launch-editor-middleware")]),t._v("中间件中作用在于最终是调用 "),n("code",[t._v("launch-editor")]),t._v(" 打开文件。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue3-project/node_modules/launch-editor-middleware/index.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'url'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" launch "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'launch-editor'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" srcRoot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// specifiedEditor => 这里传递过来的则是 () => console.log() 函数")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以和 onErrorCallback 切换下，把它赋值给错误回调函数")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" specifiedEditor "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    onErrorCallback "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" specifiedEditor\n    specifiedEditor "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果第二个参数是函数，同样把它赋值给错误回调函数")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里传递过来的是undefined")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" srcRoot "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    onErrorCallback "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" srcRoot\n    srcRoot "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// srcRoot 是传递过来的参数，或者当前node进程的目录")]),t._v("\n  srcRoot "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" srcRoot "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cwd")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 最后返回一个函数， express 中间件")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("launchEditorMiddleware")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略 ...")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("strong",[t._v("上一段中，这种切换参数的写法，在很多源码中都很常见。为的是方便用户调用时传参。虽然是多个参数，但可以传一个或者两个")]),t._v("。")]),t._v(" "),n("p",[t._v("可以根据情况打上断点。比如这里我会在"),n("code",[t._v("launch(path.resolve(srcRoot, file), specifiedEditor, onErrorCallback)")]),t._v("打断点。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue3-project/node_modules/launch-editor-middleware/index.js")]),t._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" srcRoot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略上半部分")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("launchEditorMiddleware")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根据请求解析出file路径")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" file "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果没有文件路径，则报错")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("statusCode "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),t._v("\n      res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('launch-editor-middleware: required query param "file" is missing.')]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 否则拼接路径，用launch打开。")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("srcRoot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onErrorCallback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"_6-launch-editor"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-launch-editor"}},[t._v("#")]),t._v(" 6. launch-editor")]),t._v(" "),n("p",[t._v("跟着断点来看，走到了"),n("code",[t._v("launchEditor")]),t._v("函数。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue3-project/node_modules/launch-editor/index.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("launchEditor")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 解析出文件路径和行号列号等信息")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" parsed "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" fileName "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" parsed\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" lineNumber"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" columnNumber "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" parsed\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断文件是否存在，不存在，直接返回。")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("existsSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以和 onErrorCallback 切换下，把它赋值给错误回调函数")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" specifiedEditor "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    onErrorCallback "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" specifiedEditor\n    specifiedEditor "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 包裹一层函数")]),t._v("\n  onErrorCallback "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrapErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onErrorCallback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 猜测当前进程运行的是哪个编辑器")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("guessEditor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略剩余部分，后文再讲述...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"_6-1-wraperrorcallback-包裹错误函数回调"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-wraperrorcallback-包裹错误函数回调"}},[t._v("#")]),t._v(" 6.1 wrapErrorCallback 包裹错误函数回调")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("onErrorCallback "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrapErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onErrorCallback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("这段的代码，就是传递错误回调函数，"),n("code",[t._v("wrapErrorCallback")]),t._v(" 返回给一个新的函数，"),n("code",[t._v("wrapErrorCallback")]),t._v(" 执行时，再去执行 onErrorCallback(cb)。")]),t._v(" "),n("p",[t._v("我相信读者朋友能看懂，我单独拿出来讲述，主要是因为"),n("strong",[t._v("这种包裹函数的形式在很多源码里都很常见")]),t._v("。")]),t._v(" "),n("p",[t._v("这里也就是文章开头终端错误图"),n("code",[t._v("Could not open App.vue in the editor.")]),t._v("输出的代码位置。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue3-project/node_modules/launch-editor/index.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrapErrorCallback")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("cb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" errorMessage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      chalk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("red")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Could not open '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("basename")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("' in the editor.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errorMessage"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errorMessage"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("errorMessage"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        errorMessage "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        chalk"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("red")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'The editor process exited with an error: '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" errorMessage"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" errorMessage"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h3",{attrs:{id:"_6-2-guesseditor-猜测当前正在使用的编辑器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-guesseditor-猜测当前正在使用的编辑器"}},[t._v("#")]),t._v(" 6.2 guessEditor 猜测当前正在使用的编辑器")]),t._v(" "),n("p",[t._v("这个函数主要做了如下四件事情：")]),t._v(" "),n("ol",[n("li",[t._v("如果具体指明了编辑器，则解析下返回。"),n("br")]),t._v(" "),n("li",[t._v("找出当前进程中哪一个编辑器正在运行。"),n("code",[t._v("macOS")]),t._v(" 和 "),n("code",[t._v("Linux")]),t._v(" 用 "),n("code",[t._v("ps x")]),t._v(" 命令"),n("br"),n("code",[t._v("windows")]),t._v(" 则用 "),n("code",[t._v("Get-Process")]),t._v(" 命令"),n("br")]),t._v(" "),n("li",[t._v("如果都没找到就用 "),n("code",[t._v("process.env.VISUAL")]),t._v("或者"),n("code",[t._v("process.env.EDITOR")]),t._v("。这就是为啥开头错误提示可以使用环境变量指定编辑器的原因。"),n("br")]),t._v(" "),n("li",[t._v("最后还是没有找到就返回"),n("code",[t._v("[null]")]),t._v("，则会报错。"),n("br")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("guessEditor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue3-project/node_modules/launch-editor/guess.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" shellQuote "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shell-quote'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("guessEditor")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("specifiedEditor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果指定了编辑器，则解析一下，这里没有传入。如果自己指定了路径。")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 比如 c/Users/lxchu/AppData/Local/Programs/Microsoft VS Code/bin/code ")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   会根据空格切割成 c/Users/lxchu/AppData/Local/Programs/Microsoft")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" shellQuote"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("specifiedEditor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// We can find out which editor is currently running by:")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// `ps x` on macOS and Linux")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// `Get-Process` on Windows")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  代码有删减")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("platform "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'darwin'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" output "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ps x'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("platform "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'win32'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" output "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" childProcess\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'powershell -Command \"Get-Process | Select-Object Path\"'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          stdio"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pipe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pipe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ignore'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 省略")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("platform "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'linux'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" output "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" childProcess\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("execSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ps x --no-heading -o comm --sort=comm'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ignore...")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Last resort, use old skool env vars")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("VISUAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("VISUAL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EDITOR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EDITOR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("看完了 guessEditor 函数，我们接着来看 "),n("code",[t._v("launch-editor")]),t._v(" 剩余部分。")]),t._v(" "),n("h3",{attrs:{id:"_6-3-launch-editor-剩余部分"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-launch-editor-剩余部分"}},[t._v("#")]),t._v(" 6.3 launch-editor 剩余部分")]),t._v(" "),n("p",[t._v("以下这段代码不用细看，调试的时候细看就行。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue3-project/node_modules/launch-editor/index.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("launchEditor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  省略上部分...")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("platform "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'linux'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n    fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("startsWith")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/mnt/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("Microsoft")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("i")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("release")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Assume WSL / "Bash on Ubuntu on Windows" is being used, and')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// that the file exists on the Windows file system.")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// `os.release()` is "4.4.0-43-Microsoft" in the current release')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// build of WSL, see: https://github.com/Microsoft/BashOnWindows/issues/423#issuecomment-221627364")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// When a Windows editor is specified, interop functionality can")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// handle the path translation, but only if a relative path is used.")]),t._v("\n    fileName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("relative")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lineNumber"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" extraArgs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getArgumentsForPosition")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lineNumber"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" columnNumber"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" extraArgs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isTerminalEditor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// There's an existing editor process already and it's attached")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// to the terminal, so go kill it. Otherwise two separate editor")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// instances attach to the stdin/stdout which gets confusing.")]),t._v("\n    _childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SIGKILL'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("platform "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'win32'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// On Windows, launch the editor in a shell because spawn can only")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// launch .exe files.")]),t._v("\n    _childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("spawn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cmd.exe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/C'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("concat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" stdio"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("spawn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" stdio"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  _childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'exit'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("errorCode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("errorCode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(code '")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" errorCode "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("')'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  _childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("onErrorCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fileName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("这一大段中，主要的就是"),n("strong",[t._v("以下代码")]),t._v("，用子进程模块。简单来说子进程模块有着执行命令的能力。")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("platform "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'win32'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// On Windows, launch the editor in a shell because spawn can only")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// launch .exe files.")]),t._v("\n    _childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("spawn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cmd.exe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/C'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("concat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" stdio"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    _childProcess "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" childProcess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("spawn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("editor"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" stdio"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("行文至此，就基本接近尾声了。原理其实就是利用"),n("code",[t._v("nodejs")]),t._v("中的"),n("code",[t._v("child_process")]),t._v("，执行了类似"),n("code",[t._v("code path/to/file")]),t._v("命令。")]),t._v(" "),n("h2",{attrs:{id:"_7-总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-总结"}},[t._v("#")]),t._v(" 7. 总结")]),t._v(" "),n("p",[t._v("这里总结一下：首先文章开头通过提出「短时间找不到页面对应源文件的场景」，并针对容易碰到的报错情况给出了解决方案。\n其次，配置了环境跟着调试学习了"),n("code",[t._v("vue-devtools")]),t._v("中使用的尤大写的 "),n("a",{attrs:{href:"https://github.com/yyx990803/launch-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("yyx990803/launch-editor"),n("OutboundLink")],1),t._v("。")]),t._v(" "),n("h3",{attrs:{id:"_7-1-一句话简述其原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-一句话简述其原理"}},[t._v("#")]),t._v(" 7.1 一句话简述其原理")]),t._v(" "),n("p",[t._v("我们回顾下开头的原理内容。")]),t._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[t._v("code path/to/file\n")])])]),n("p",[t._v("一句话简述原理：利用"),n("code",[t._v("nodejs")]),t._v("中的"),n("code",[t._v("child_process")]),t._v("，执行了类似"),n("code",[t._v("code path/to/file")]),t._v("命令，于是对应编辑器就打开了相应的文件，而对应的编辑器则是通过在进程中执行"),n("code",[t._v("ps x")]),t._v("（"),n("code",[t._v("Window")]),t._v("则用"),n("code",[t._v("Get-Process")]),t._v("）命令来查找的，当然也可以自己指定编辑器。")]),t._v(" "),n("p",[t._v("最后还能做什么呢。")]),t._v(" "),n("p",[t._v("可以再看看 "),n("a",{attrs:{href:"https://github.com/umijs/launch-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("umijs/launch-editor"),n("OutboundLink")],1),t._v(" 和 "),n("a",{attrs:{href:"https://github.com/facebook/create-react-app/blob/master/packages/react-dev-utils/launchEditor.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-dev-utils/launchEditor.js"),n("OutboundLink")],1),t._v(" 。他们的代码几乎类似。")]),t._v(" "),n("p",[t._v("也可以利用"),n("code",[t._v("Node.js")]),t._v("做一些提高开发效率等工作，同时可以学习"),n("code",[t._v("child_process")]),t._v("等模块。")]),t._v(" "),n("p",[n("strong",[t._v("也不要禁锢自己的思维，把前端禁锢在页面中，应该把视野拓宽")]),t._v("。")]),t._v(" "),n("p",[n("strong",[n("code",[t._v("Node.js")]),t._v("是我们前端人探索操作文件、操作网络等的好工具")]),t._v("。")]),t._v(" "),n("blockquote",[n("p",[t._v("如果读者朋友发现有不妥或可改善之处，再或者哪里没写明白的地方，欢迎评论指出。另外觉得写得不错，对您有些许帮助，可以点赞、评论、转发分享，也是对我的一种支持，万分感谢。如果能关注我的前端公众号："),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/c3hFML3XN9KCUetDOZd-DQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("「若川视野」"),n("OutboundLink")],1),t._v("，就更好啦。")])]),t._v(" "),n("h2",{attrs:{id:"关于"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于"}},[t._v("#")]),t._v(" 关于")]),t._v(" "),n("blockquote",[n("p",[t._v("你好，我是"),n("a",{attrs:{href:"https://lxchuan12.gitee.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("若川"),n("OutboundLink")],1),t._v("，微信搜索"),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/c3hFML3XN9KCUetDOZd-DQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("「若川视野」"),n("OutboundLink")],1),t._v("关注我，专注前端技术分享，一个愿景是帮助5年内前端开阔视野走向前列的公众号。欢迎加我微信"),n("code",[t._v("ruochuan12")]),t._v("，长期交流学习。\n主要有以下系列文章："),n("a",{attrs:{href:"https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA5MjQwMzQyNw==&action=getalbum&album_id=1342211915371675650#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("学习源码整体架构系列"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA5MjQwMzQyNw==&action=getalbum&album_id=1668518390266724360#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("年度总结"),n("OutboundLink")],1),t._v("、"),n("a",{attrs:{href:"https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzA5MjQwMzQyNw==&action=getalbum&album_id=1342989113611419648#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("JS基础系列"),n("OutboundLink")],1)])]),t._v(" "),n("h2",{attrs:{id:"参考链接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/yyx990803/launch-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("yyx990803/launch-editor"),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/umijs/launch-editor",target:"_blank",rel:"noopener noreferrer"}},[t._v("umijs/launch-editor"),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuejs/vue-devtools"),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools/blob/dev/docs/open-in-editor.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue-devtools open-in-editor.md"),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools/issues/821",target:"_blank",rel:"noopener noreferrer"}},[t._v('"Open in editor" button doesn\'t work in Win 10 with VSCode if installation path contains spaces'),n("OutboundLink")],1),n("br"),t._v(" "),n("a",{attrs:{href:"https://github.com/facebook/create-react-app/blob/master/packages/react-dev-utils/launchEditor.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-dev-utils/launchEditor.js"),n("OutboundLink")],1),n("br")])])}),[],!1,null,null,null);s.default=e.exports}}]);